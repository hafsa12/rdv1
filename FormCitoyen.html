<fieldset>
	<legend><com:TTranslate>VALIDATION_DU_RENDEZ_VOUS</com:TTranslate></legend>
	<h3><com:TTranslate>RECAPITULATIF_DE_VOTRE_DEMANDE_DE_RENDEZ_VOUS</com:TTranslate></h3>
	<div class="row-fluid">
		<div class="span7">
			<div class="bloc-recap">
				<div class="recap">
					<p>
						<span style="display:<%=((!$this->visibleRecapDetails) || $this->Page->Master->isCalledFromAdmin())?'none':''%>">
						<com:TTranslate>ETABLISSEMENT</com:TTranslate> : <strong><com:TLabel Id="nomEtab"/></strong><br>
						<com:TTranslate>ADRESSE</com:TTranslate> : <strong><com:TLabel Id="adresseEtab"/></strong><br>
						<!-- <com:TLiteral Visible="<%=$this->telEtab->Text!=''%>"><com:TTranslate>TELEPHONE_POUR_PRISE_RDV</com:TTranslate> : <strong><com:TLabel Id="telEtab"/></strong><br></com:TLiteral> -->
						
</span>
						<com:TTranslate>NIVEAU1</com:TTranslate> : <strong><com:TLabel Id="typePrestation"/></strong><br>
						<com:TTranslate>NIVEAU2</com:TTranslate> : <strong><com:TLabel Id="prestation"/></strong>
						<com:TLabel Id="champsSupp"/>
						<com:TLabel Id="niveau3"/><strong><com:TLabel Id="ressource"/> </strong><br>
						<com:TTranslate>HORAIRES</com:TTranslate> : <strong><com:TLabel Id="dateRdv"/></strong>
                    </p>

							<com:TRepeater ID="repeaterRdvGroupe">
								<prop:HeaderTemplate>
                                    <p class="heures">
                                        <strong><com:TTranslate>PREFERENCE</com:TTranslate> :</strong>
                                    <label class="radio inline" >
                                        <input type="radio" name="tranches" onclick="selectHeures(800, 1000);"/><com:TTranslate>8_A_10</com:TTranslate>
                                    </label>
                                    <label class="radio inline" >
                                        <input type="radio" name="tranches" onclick="selectHeures(1000, 1200);"/><com:TTranslate>10_A_12</com:TTranslate>
                                    </label>
                                    <label class="radio inline" >
                                        <input type="radio" name="tranches" onclick="selectHeures(1200, 1400);"/><com:TTranslate>12_A_14</com:TTranslate>
                                    </label>
                                    <label class="radio inline" >
                                        <input type="radio" name="tranches" onclick="selectHeures(1400, 1600);"/><com:TTranslate>14_A_16</com:TTranslate>
                                    </label>
                                    <label class="radio inline" >
                                        <input type="radio" name="tranches" onclick="selectHeures(1600, 1800);"/><com:TTranslate>16_A_18</com:TTranslate>
                                    </label>
                                    </p>
									<table class="heures">
								</prop:HeaderTemplate>
								<prop:ItemTemplate>
									<tr>
										<td><strong><com:TLabel Id="dateRdv" Text="<%#Prado::localize('LE').' '.Atexo_Utils_Util::getNomDate($this->DataItem['dateIso']).' '.Prado::localize('A').' '%>"/></strong></td>
										<td>&nbsp;&nbsp;:&nbsp;&nbsp;<com:TDropDownList ID="listeHeures" SelectedIndex="0" DataSource="<%#$this->DataItem['listeHeures']%>" DataTextField="heureDebut" DataValueField="heureDebut" CssClass="input-small list-heure"/></td>
									</tr>
								</prop:ItemTemplate>
								<prop:FooterTemplate>
									</table>
								</prop:FooterTemplate>
							</com:TRepeater>
                    <script type="application/javascript">
                        function selectHeures(start,end) {
                            var inputID = "";
                            var sufixCheckBox = "_checkbox";
                            J('.list-heure').each(function() {
                                var elem = J(this);
                                J("#"+J(this).attr('id')+" option").each(function()
                                {
                                    heure = parseInt(J(this).val().replace(':', ''));
                                    if( heure >= start && heure < end) {
                                        elem.val(J(this).val());
                                        return false;
                                    }
                                });
                            });
                        }
                    </script>
					<br/>
				</div>
			</div>
			<h3><com:TTranslate>MESSAGE_CONFIRMATION_RENDEZ_VOUS</com:TTranslate></h3>

<!--			<com:TPanel Visible="<%=Atexo_User_CurrentUser::isAdmin()%>" CssClass="control-group">
				<div class="control-label label-auto"><com:TTranslate>MODE_PRISE_RENDEZ_VOUS</com:TTranslate> :</div>
				<label class="radio inline" >
					<com:TRadioButton GroupName="typePrise" id="priseTel" Text="<%=Prado::localize('TELEPHONE')%>"/>
				</label>
				<label class="radio inline" >
					<com:TRadioButton GroupName="typePrise" id="surPlace" Text="<%=Prado::localize('SUR_PLACE')%>"/>
				</label>
				<com:TRequiredFieldValidator ValidationGroup="validation" ControlToValidate="priseTel" ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>" Display="Dynamic" />
			</com:TPanel> -->
			<com:TPanel Visible="<%=Atexo_User_CurrentUser::isAdmin()%>" CssClass="control-group">

				<div class="controls">
					<com:TAutoComplete
							ID="motsCles"
							Attributes.placeholder="<%=Prado::localize('RECHERCHER_CITOYEN')%>"
							OnSuggest="suggestNames"
							OnSuggestionSelected="suggestionSelected"
							Suggestions.DataKeyField="ID_CITOYEN"
							ResultPanel.CssClass="acomplete"
							MinChars="3"
							Attributes.onmousedown="dropText(this)"
					>
						<prop:Suggestions.ItemTemplate>
							<li title="<%# $this->Data['NOM_CITOYEN']%>"><%# $this->Data['NOM_CITOYEN']%></li>
						</prop:Suggestions.ItemTemplate>
					</com:TAutoComplete>
				</div>
			</com:TPanel>
			<com:TActivePanel Id="panelFormCitoyen">
				<com:TPanel Id="panelText1" CssClass="control-group" Visible="false">
					<label class="control-label"><com:TLabel Id="labelText1"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="text1" />
						<com:TRequiredFieldValidator
								Id="text1Validator"
								ControlToValidate="text1"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelText2" CssClass="control-group" Visible="false">
					<label class="control-label"><com:TLabel Id="labelText2"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="text2" />
						<com:TRequiredFieldValidator
								Id="text2Validator"
								ControlToValidate="text2"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelText3" CssClass="control-group" Visible="false">
					<label class="control-label"><com:TLabel Id="labelText3"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="text3" />
						<com:TRequiredFieldValidator
								Id="text3Validator"
								ControlToValidate="text3"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelRaisonSocial" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->identifiant->ClientId%>"><com:TTranslate>RAISON_SOCIAL</com:TTranslate> <com:TLabel Id="labelRaisonSocial"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="raisonSocial" />
						<com:TRequiredFieldValidator
								Id="raisonSocialValidator"
								ControlToValidate="raisonSocial"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelIdentifiant" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->identifiant->ClientId%>"><com:TTranslate>IDENTIFIANT</com:TTranslate> <com:TLabel Id="labelIdentifiant"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="identifiant" />
						<com:TRequiredFieldValidator
								Id="identifiantValidator"
								ControlToValidate="identifiant"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelNom" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->nom->ClientId%>"><com:TTranslate>NOM</com:TTranslate> <com:TLabel Id="labelNom"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="nom" />
						<com:TRequiredFieldValidator
								Id="nomValidator"
								ControlToValidate="nom"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelPrenom" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->prenom->ClientId%>"><com:TTranslate>PRENOM</com:TTranslate> <com:TLabel Id="labelPrenom"/> : </label>
					<div class="controls">
						<com:TTextBox ID="prenom" />
						<com:TRequiredFieldValidator
								Id="prenomValidator"
								ControlToValidate="prenom"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelNaissance" CssClass="control-group date-naissance">
					<label class="control-label" for="<%=$this->naissance->ClientId%>"><com:TTranslate>DATE_NAISSANCE</com:TTranslate> <com:TLabel Id="labelNaissance"/> : </label>
					<div class="controls">
						<com:TDatePicker
								ID="naissance"
								Culture="<%=Atexo_User_CurrentUser::readFromSession('lang')%>"
								DateFormat="dd/MM/yyyy"
								FromYear='1930'
								UpToYear="<%=date('Y')%>"/>
						<com:TRequiredFieldValidator
								Id="naissanceValidator"
								ControlToValidate="naissance"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
						<com:TDataTypeValidator
								ValidationGroup="validation"
								ControlToValidate="naissance"
								DataType="Date"
								DateFormat="dd/MM/yyyy"
								Text="<%=Prado::localize('ERROR_FORMAT_DATE')%>"
								Display="Dynamic" />
						<com:TCompareValidator
								Id="naissanceCompareValidator"
								ValidationGroup="validation"
								ControlToValidate="naissance"
								DataType="Date"
								DateFormat="dd/MM/yyyy"
								Operator="LessThan"
								ValueToCompare="<%=date('d/m/Y')%>"
								Text="<%=Prado::localize('ERROR_DATE_NAISSANCE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelAdresse" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->prenom->ClientId%>"><com:TTranslate>ADRESSE</com:TTranslate> <com:TLabel Id="labelAdresse"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="adresse" cssclass="input-xlarge" TextMode="MultiLine"/>
						<com:TRequiredFieldValidator
								Id="adresseValidator"
								ControlToValidate="adresse"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelEmail" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->email->ClientId%>"><com:TTranslate>EMAIL</com:TTranslate> <com:TLabel Id="labelEmail"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="email" />
						<com:TEmailAddressValidator
								ControlToValidate="email"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('EMAIL_INVALID')%>"
								Display="Dynamic" />
						<com:TCustomValidator
								Id="emailOrTelValidatorEmail"
								ControlToValidate="email"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('EMAIL_OU_TELEPHONE_OBLIGATOIRE')%>"
								Display="Dynamic"
								ClientValidationFunction="validationEmailOrTelephoneCitoyen"
						/>
						<com:TRequiredFieldValidator
								Id="emailValidator"
								ControlToValidate="email"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
					</div>
				</com:TPanel>
				<com:TPanel Id="panelTelephone" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->telephone->ClientId%>"><com:TTranslate>TELEPHONE</com:TTranslate><com:TLabel Id="labelTelephone"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="telephone" />
						<com:TCustomValidator
								Id="emailOrTelValidatorTel"
								ControlToValidate="telephone"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('EMAIL_OU_TELEPHONE_OBLIGATOIRE')%>"
								Display="Dynamic"
								ClientValidationFunction="validationEmailOrTelephoneCitoyen"
						/>
						<com:TRequiredFieldValidator
								Id="telephoneValidator"
								ControlToValidate="telephone"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic" />
						<com:TRegularExpressionValidator
								ValidationGroup="validation"
								ControlToValidate="telephone"
								Display="Dynamic"
								RegularExpression="^(0[1-9]|\+[1-9]{1,3}[\s\.\-][1-9]|0{1,2}[1-9]{1,3}[\s\.\-][1-9])[\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}$"
								Text="<%=Prado::localize('FORMAT_TEL_INCORRECT')%>"/>
					</div>
				</com:TPanel>
				<com:TPanel Id="panelFax" CssClass="control-group" Visible="false">
					<label class="control-label" for="<%=$this->telephone->ClientId%>"><com:TTranslate>FAX</com:TTranslate> <com:TLabel Id="labelFax"/> :  </label>
					<div class="controls">
						<com:TTextBox ID="fax" />
						<com:TRequiredFieldValidator
								Id="faxValidator"
								ControlToValidate="fax"
								ValidationGroup="validation"
								ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
								Display="Dynamic"/>
						<com:TRegularExpressionValidator
								ValidationGroup="validation"
								ControlToValidate="fax"
								Display="Dynamic"
								RegularExpression="^0[1-9][\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}[\s\.\-]?[0-9]{2}$"
								Text="<%=Prado::localize('FORMAT_TEL_INCORRECT')%>"/>
					</div>
				</com:TPanel>
<script type="text/javascript">

	function fileValidation(obj){
		var filePath=obj.value;
		var val=filePath.split(".").pop();

		if(!['jpeg','jpg','png','gif','bmp','pdf'].includes(val)){
			
			alert("Veuillez choisir un fichier au format PDF ou image");
			obj.value='';
			return false;
		}

		else 
			if(obj.files[0].size > 2097152){
			alert("La taille du fichier doit Ãªtre infÃ©rieure Ã  2MB");
			obj.value='';
			return false;


		}

	}

</script>

<com:TPanel Visible="<%=Atexo_User_CurrentUser::isAdmin()%>" CssClass="control-group">
	<com:TActivePanel ID="listePjPanel"
				cssClass="panel-resultats" >
					</br>
					<com:TActiveRepeater ID="listePj">
						<prop:HeaderTemplate>
						</prop:HeaderTemplate>
						<prop:ItemTemplate>
							<div class="control-group">
								<com:TLabel Id="blobName" cssclass="control-label" Text='<%=$this->DataItem["libelle"]%>'/>
							
							<div class="controls">
				                         <com:TActivePanel Id="panelInputPj" CssClass="fileupload fileupload-new"> 
				                           <com:TFileUpload id="pj" CssClass="fileupload-new" Attributes.onchange="return fileValidation(this)" Attributes.accept="application/pdf,image/*"/>

			                          										
				                    </div>
</div>	
						</prop:ItemTemplate>
						<prop:FooterTemplate>
						</prop:FooterTemplate>
					</com:TActiveRepeater>
<br/>
<com:TLabel Text="<%=Prado::localize('FILE_SIZE')%>" style='margin-left:35px;color:red; font-size:11px;'/>
<br/><com:TLabel Text="<%=Prado::localize('FILE_TYPE')%>" style='margin-left:35px;color:red;font-size:11px;' />						    

				</com:TActivePanel>
</com:TPanel>

<com:TPanel Visible="<%=Atexo_User_CurrentUser::isCitoyen()%>" CssClass="control-group">

	<com:TActivePanel ID="listePjPanel"
				cssClass="panel-resultats" >
					</br>
					<com:TActiveRepeater ID="listePj">
						<prop:HeaderTemplate>
						</prop:HeaderTemplate>
						<prop:ItemTemplate>
							<div class="control-group">
								<com:TLabel Id="blobName" cssclass="control-label" Text='<%=$this->DataItem["libelle"]%>'/>
							
							<div class="controls">
				                         <com:TActivePanel Id="panelInputPj" CssClass="fileupload fileupload-new"> 
				                           <com:TFileUpload id="pj" CssClass="fileupload-new" Attributes.onchange="return fileValidation(this)" Attributes.accept="application/pdf,image/*"/>

			                             <com:TRequiredFieldValidator
												Id="pjValidator"
												ControlToValidate="pj"
												ValidationGroup="validation"
												ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>"
												Display="Dynamic" />

				                      </com:TActivePanel>										
				                    </div>
</div>	
						</prop:ItemTemplate>
						<prop:FooterTemplate>
						</prop:FooterTemplate>
					</com:TActiveRepeater>
<br/>
<com:TLabel Text="<%=Prado::localize('FILE_SIZE')%>" style='margin-left:35px;color:red; font-size:11px;'/>
<br/><com:TLabel Text="<%=Prado::localize('FILE_TYPE')%>" style='margin-left:35px;color:red;font-size:11px;' />						    

				</com:TActivePanel>

</com:TPanel>
				<!-- <com:TActivePanel ID="listePjPanel" -->
				<!-- cssClass="panel-resultats" > -->
					<!-- </br> -->
					<!-- <com:TActiveRepeater ID="listePj"> -->
						<!-- <prop:HeaderTemplate> -->
						<!-- </prop:HeaderTemplate> -->
						<!-- <prop:ItemTemplate> -->
							<!-- <div class="control-group"> -->
								<!-- <com:TLabel Id="blobName" cssclass="control-label" Text='<%=$this->DataItem["libelle"]%>'/> -->
							
							<!-- <div class="controls"> -->
				                         <!-- <com:TActivePanel Id="panelInputPj" CssClass="fileupload fileupload-new">  -->
				                           <!-- <com:TFileUpload id="pj" CssClass="fileupload-new" Attributes.onchange="return fileValidation(this)" Attributes.accept="application/pdf,image/*"/> -->

			                             <!-- <com:TRequiredFieldValidator -->
												<!-- Id="pjValidator" -->
												<!-- ControlToValidate="pj" -->
												<!-- ValidationGroup="validation" -->
												<!-- ErrorMessage="<%=Prado::localize('CHAMP_OBLIGATOIRE')%>" -->
												<!-- Display="Dynamic" /> -->

				                      <!-- </com:TActivePanel>										 -->
				                    <!-- </div> -->
<!-- </div>	 -->
						<!-- </prop:ItemTemplate> -->
						<!-- <prop:FooterTemplate> -->
						<!-- </prop:FooterTemplate> -->
					<!-- </com:TActiveRepeater> -->
<!-- <br/> -->
<!-- <com:TLabel Text="<%=Prado::localize('FILE_SIZE')%>" style='margin-left:35px;color:red; font-size:11px;'/> -->
<!-- <br/><com:TLabel Text="<%=Prado::localize('FILE_TYPE')%>" style='margin-left:35px;color:red;font-size:11px;' />						     -->

				<!-- </com:TActivePanel> -->
			</com:TActivePanel>
		</div>
		<div class="span5">
			<div class="bloc-map" style="display:none;">
			<com:PlanAcces Id="planAcces"/>	
			</div>
			<com:CommentaireEtPiece Id="commentaireEtPiece"/>
		</div>
	</div>


</fieldset>